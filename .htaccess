<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Permitir acceso directo a archivos estáticos en public/
    # CSS, JS, imágenes, etc.
    RewriteCond %{REQUEST_URI} ^/ModuStackAdmin/(css|js|images|build|storage)/
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule ^ModuStackAdmin/(.*)$ public/$1 [L]
    
    # Si el request es directamente a public/, permitirlo
    RewriteCond %{REQUEST_URI} ^/ModuStackAdmin/public/
    RewriteRule ^(.*)$ - [L]
    
    # Si es un archivo existente en la raíz del proyecto, permitirlo
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteRule ^(.*)$ - [L]
    
    # Si es un directorio existente, permitirlo
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^(.*)$ - [L]
    
    # Redirigir requests en /ModuStackAdmin/ (excepto archivos estáticos) a public/
    RewriteCond %{REQUEST_URI} ^/ModuStackAdmin/
    RewriteCond %{REQUEST_URI} !^/ModuStackAdmin/(css|js|images|build|storage)/
    RewriteRule ^ModuStackAdmin/(.*)$ public/$1 [L]
    
    # Si está en la raíz del proyecto (sin subdirectorio), redirigir a public/
    RewriteCond %{REQUEST_URI} !^/ModuStackAdmin/
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ public/$1 [L]
</IfModule>
